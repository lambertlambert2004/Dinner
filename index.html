<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
<meta http-equiv="Pragma" content="no-cache">
<meta http-equiv="Expires" content="0">
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>School Dinner Menu</title>
<link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/lambertlambert2004/Dinner/main/icon-180.PNG">
<style>
:root{
  --bg:#f7f7f7;
  --card:#fff;
  --muted:#888;
  --text:#222;
  --accent:#007aff;
  --warm:#ff9500;
  --packed-bg:#fff9d6;
  --other-bg-start:#f0fff6;
  --other-bg-end:#e6fff2;
}
html,body{height:100%;margin:0;padding:0;background:var(--bg);font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Helvetica,Arial,sans-serif;color:var(--text);}
.app{max-width:820px;margin:0 auto;padding:20px;}
h1{text-align:center;font-weight:800;font-size:1.6rem;margin:0 0 8px;}
h1::after{content:"";display:block;margin:8px auto 0;width:60px;height:2px;background:#e3e4e8;border-radius:2px;}
.meta{text-align:center;margin-bottom:14px;}
.week-label{font-weight:700;font-size:1rem;}
.week-dates{font-size:.9rem;color:var(--muted);margin-top:6px;}
#menuContainer{display:flex;flex-direction:column;gap:14px;position:relative;overflow-y:auto;max-height:70vh;padding-bottom:20px;}
.card{background:var(--card);border-radius:14px;padding:14px;position:relative;opacity:0;transform:translateY(12px) scale(0.98);transition:transform .35s ease,opacity .3s ease, box-shadow .3s ease;}
.card.other-day{background:linear-gradient(145deg,var(--other-bg-start),var(--other-bg-end));}
.card.packed{background:linear-gradient(145deg,var(--packed-bg),#fff4b2);}
.day-name{font-weight:700;font-size:1.05rem;margin-bottom:8px;color:var(--text);}
.meals{white-space:pre-line;font-size:.96rem;color:#333;line-height:1.5;margin-bottom:6px;}
.label{position:absolute;top:12px;right:12px;font-weight:700;font-size:.73rem;color:#fff;padding:6px 9px;border-radius:11px;display:flex;align-items:center;z-index:2;}
.label.today{background:#007aff;animation:glowToday 2s ease-in-out infinite alternate;}
.label.tomorrow{background:#ff9500;animation:glowTomorrow 3s ease-in-out infinite alternate;}
@keyframes glowToday {0% { box-shadow:0 0 6px 2px rgba(0,122,255,0.4); } 50% { box-shadow:0 0 14px 4px rgba(0,122,255,0.5);} 100% { box-shadow:0 0 6px 2px rgba(0,122,255,0.4); }}
@keyframes glowTomorrow {0% { box-shadow:0 0 6px 2px rgba(255,149,0,0.4); } 50% { box-shadow:0 0 14px 4px rgba(255,149,0,0.5);} 100% { box-shadow:0 0 6px 2px rgba(255,149,0,0.4); }}
.toggle{display:inline-block;width:56px;height:32px;position:relative;margin-top:6px;}
.toggle input{opacity:0;width:0;height:0;}
.slider{position:absolute;inset:0;border-radius:32px;background:#ddd;transition:background .22s,border-color .22s;}
.slider::before{content:"";position:absolute;left:4px;bottom:4px;width:24px;height:24px;background:#fff;border-radius:50%;transition:transform .18s, box-shadow .18s;}
input:checked + .slider{background:#34c759;}
input:checked + .slider::before{transform:translateX(24px);}
.controls {
  display:flex;
  justify-content:center;
  gap:12px;
  position: sticky;
  bottom: 60px; /* lifted above Safari bottom bar */
  background: transparent;
  padding-top: 8px;
  padding-bottom: 8px;
  z-index: 10;
}
.week-toggle{background:#007aff;color:#fff;border:none;padding:12px 18px;border-radius:12px;cursor:pointer;font-weight:700;box-shadow:0 8px 22px rgba(0,122,255,0.18);}
.week-toggle:active{transform:scale(.99);background:#0062cc;}
@media(max-width:420px){.app{padding:14px;} h1{font-size:1.35rem;} .week-toggle{padding:10px 14px;}}
</style>
</head>
<body>
<div class="app">
  <h1>School Dinner Menu</h1>
  <div class="meta">
    <div class="week-label" id="weekLabel">Week</div>
    <div class="week-dates" id="weekDates"></div>
  </div>
  <div id="menuContainer" aria-live="polite"></div>
  <div class="controls">
    <button id="toggleWeekBtn" class="week-toggle">View Next Week</button>
    <button id="returnWeekBtn" class="week-toggle" style="display:none;">Return to Current Week</button>
  </div>
  <footer style="margin-top:18px;text-align:center;color:#666;font-size:.88rem;">
    Baked salmon available every Friday as an alternative. Data last updated per Swansea Council 2025.
  </footer>
</div>
<script>
// MENU DATA (Week 1â€“3 exact from Swansea Council site)
const MENUS = {
  1:{
    Monday:"Oven baked sausages / Vegetarian sausage\nAccompaniments of the day\nFruit / Biscuit",
    Tuesday:"BBQ chicken wrap / Cheese and tomato pizza\nAccompaniments of the day\nFruit yoghurt / Fresh fruit",
    Wednesday:"Cheesy beany jacket / Breaded chicken steak\nAccompaniments of the day\nPancake and fruit",
    Thursday:"Cottage pie / Tomato pasta bake\nAccompaniments of the day\nCookie / Fresh fruit",
    Friday:"Baked fish / Cheese wrap\nAccompaniments of the day\nJam split and fruit wedge"
  },
  2:{
    Monday:"Breaded chicken steak / Vegetable cheese bake\nAccompaniments of the day\nFruit yoghurt pot / Fresh fruit",
    Tuesday:"Pasta bolognese / Vegetarian hotdog\nAccompaniments of the day\nFruit muffin / Fresh fruit",
    Wednesday:"Roast turkey / Vegetarian sausage\nAccompaniments of the day\nIce cream / Fresh fruit",
    Thursday:"Chicken curry / Macaroni cheese\nAccompaniments of the day\nCookie / Fresh fruit",
    Friday:"Fish fingers / Cheese and tomato pizza\nAccompaniments of the day\nFruit wedge / Shortbread"
  },
  3:{
    Monday:"Cheese and tomato pizza / Chicken curry\nAccompaniments of the day\nChocolate sponge and custard / Fresh fruit",
    Tuesday:"Chicken curry / Vegetarian hotdog\nAccompaniments of the day\nFruit yoghurt pot / Fresh fruit",
    Wednesday:"Roast chicken / Quorn fillet\nAccompaniments of the day\nFruit / Flapjack",
    Thursday:"Beef burger / Vegetarian lasagne\nAccompaniments of the day\nCookie / Fresh fruit",
    Friday:"Fish cake / Vegetable nuggets\nAccompaniments of the day\nFruit jelly / Fresh fruit"
  }
};
const weekMap=[
  {week:1,start:"2025-09-01"},
  {week:2,start:"2025-09-08"},
  {week:3,start:"2025-09-15"}
];
// Helpers
const weekdays=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
function getWeekNum(date){
  const d=new Date(date);
  for(let i=weekMap.length-1;i>=0;i--){
    if(d>=new Date(weekMap[i].start)) return weekMap[i].week;
  }
  return 1;
}
function getNextWeekNum(w){return w%3+1;}
function getCurrentAndTomorrow(){
  let t=new Date(); let tn=weekdays[t.getDay()];
  let tm=new Date(t); tm.setDate(tm.getDate()+1);
  if(tm.getDay()===6) tm.setDate(tm.getDate()+2);
  if(tm.getDay()===0) tm.setDate(tm.getDate()+1);
  return {today:tn,tomorrow:weekdays[tm.getDay()]};
}
// STATE
let showWeek=getWeekNum(new Date());
// RENDER
function renderWeek(w){
  const mc=document.getElementById("menuContainer"); mc.innerHTML="";
  const {today,tomorrow}=getCurrentAndTomorrow();
  document.getElementById("weekLabel").textContent=`Week ${w}`;
  document.getElementById("weekDates").textContent="(see Swansea Council website)";
  const packed=JSON.parse(localStorage.getItem("packedLunch")||"{}");
  ["Monday","Tuesday","Wednesday","Thursday","Friday"].forEach(day=>{
    const c=document.createElement("div"); c.className="card";
    if(packed[w]&&packed[w][day]) c.classList.add("packed"); else c.classList.add("other-day");
    const dn=document.createElement("div"); dn.className="day-name"; dn.textContent=day;
    const m=document.createElement("div"); m.className="meals"; m.textContent=MENUS[w][day]||"No data";
    const lab=document.createElement("span");
    if(day===today){lab.textContent="Today";lab.className="label today";}
    else if(day===tomorrow){lab.textContent="Tomorrow";lab.className="label tomorrow";}
    if(lab.textContent) m.appendChild(lab);
    const td=document.createElement("label"); td.className="toggle";
    const i=document.createElement("input"); i.type="checkbox"; i.checked=!!(packed[w]&&packed[w][day]);
    const s=document.createElement("span"); s.className="slider";
    td.appendChild(i); td.appendChild(s);
    i.addEventListener("change",()=>{
      const chk=i.checked;
      const act=chk?"add packed lunch for":"remove packed lunch for";
      if(!confirm(`Are you sure you want to ${act} ${day}?`)){i.checked=!chk;return;}
      if(!packed[w]) packed[w]={};
      if(chk){packed[w][day]=true; c.classList.add("packed"); c.classList.remove("other-day");}
      else{delete packed[w][day]; c.classList.remove("packed"); c.classList.add("other-day");}
      localStorage.setItem("packedLunch",JSON.stringify(packed));
      updateBadge();
    });
    c.appendChild(dn); c.appendChild(m); c.appendChild(td); mc.appendChild(c);
    setTimeout(()=>{c.style.opacity=1;c.style.transform="none";},50);
  });
}
function updateBadge(){
  let todayWeek=getWeekNum(new Date());
  let packed=JSON.parse(localStorage.getItem("packedLunch")||"{}");
  let cnt=0;if(packed[todayWeek]) cnt=Object.keys(packed[todayWeek]).length;
  if("setAppBadge"in navigator){if(cnt>0) navigator.setAppBadge(cnt).catch(()=>{}); else navigator.clearAppBadge().catch(()=>{});}
  document.title=cnt>0?`(${cnt}) School Dinner Menu`:"School Dinner Menu";
}
document.getElementById("toggleWeekBtn").addEventListener("click",()=>{showWeek=getNextWeekNum(showWeek);renderWeek(showWeek);document.getElementById("returnWeekBtn").style.display="inline-block";});
document.getElementById("returnWeekBtn").addEventListener("click",()=>{showWeek=getWeekNum(new Date());renderWeek(showWeek);document.getElementById("returnWeekBtn").style.display="none";});
renderWeek(showWeek);updateBadge();
</script>
</body>
</html>
