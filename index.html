<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>School Dinner Menu</title>
<link href="https://fonts.googleapis.com/css2?family=SF+Pro+Display:wght@400;500;700&display=swap" rel="stylesheet">
<style>
  body {
    font-family: 'SF Pro Display', -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    margin:0; padding:20px; background:#f7f7f7;
    color:#222;
  }
  h1 {
    text-align:center;
    margin-bottom:5px;
    font-weight:700;
    font-size:1.6rem;
  }
  .week-label {
    text-align:center;
    font-size:1rem;
    font-weight:600;
    color:#444;
  }
  .week-dates {
    text-align:center;
    font-size:0.9rem;
    color:#888;
    margin-bottom:20px;
  }
  .card {
    background:#fff;
    border-radius:16px;
    padding:16px;
    margin-bottom:16px;
    box-shadow:0 4px 12px rgba(0,0,0,0.08);
    position:relative;
    transition:transform 0.2s ease, box-shadow 0.2s ease;
  }
  .card:hover {
    transform:translateY(-2px);
    box-shadow:0 6px 16px rgba(0,0,0,0.1);
  }
  .day-name {
    font-size:1.1rem;
    font-weight:600;
    margin-bottom:8px;
  }
  .meals {
    white-space:pre-line;
    color:#333;
    margin-bottom:12px;
    font-size:0.95rem;
  }
  .label {
    position:absolute;
    top:12px;
    right:12px;
    font-size:0.75rem;
    font-weight:bold;
    color:#fff;
    padding:4px 8px;
    border-radius:12px;
    box-shadow:0 2px 6px rgba(0,0,0,0.15);
  }
  .label.today { background:#007aff; }
  .label.tomorrow { background:#ff9500; }
  .toggle {
    position:relative; display:inline-block; width:50px; height:28px;
  }
  .toggle input { opacity:0; width:0; height:0; }
  .slider {
    position:absolute; cursor:pointer; top:0; left:0; right:0; bottom:0;
    background-color:#ccc; transition:.4s; border-radius:28px;
  }
  .slider:before {
    position:absolute; content:""; height:22px; width:22px; left:3px; bottom:3px;
    background-color:white; transition:.4s; border-radius:50%;
  }
  input:checked + .slider { background-color:#4cd964; }
  input:checked + .slider:before { transform:translateX(22px); }
  .packed { background:#fffbe6; }
  .today-card {
    border:2px solid #007aff;
    animation: glowPulseBlue 4s ease-in-out infinite;
  }
  @keyframes glowPulseBlue {
    0%,100% { box-shadow:0 0 12px 2px #007aff; }
    50% { box-shadow:0 0 20px 3px #007aff; }
  }
  .week-toggle {
    display:block;
    margin:20px auto;
    padding:12px 22px;
    background:#007aff;
    color:#fff;
    font-weight:600;
    font-size:1rem;
    border:none;
    border-radius:12px;
    cursor:pointer;
    text-align:center;
    box-shadow:0 4px 10px rgba(0,122,255,0.25);
    transition:background 0.2s ease, transform 0.1s ease;
  }
  .week-toggle:active {
    background:#0062cc;
    transform:scale(0.98);
  }
  footer {
    margin-top:20px;
    text-align:center;
    font-size:.85rem;
    color:#555;
  }
</style>
</head>
<body>
<h1>School Dinner Menu</h1>
<div class="week-label" id="weekLabel"></div>
<div class="week-dates" id="weekDates"></div>
<div id="menuContainer"></div>
<button id="toggleWeekBtn" class="week-toggle"></button>
<footer>Baked salmon available every Friday as an alternative. Data last updated per Swansea Council 2025.</footer>

<script>
// Week mapping
const weekMap = [
  { week:1, dates:["2025-09-01","2025-09-22","2025-10-13","2025-11-10","2025-12-01"] },
  { week:2, dates:["2025-09-08","2025-09-29","2025-10-20","2025-11-17","2025-12-08"] },
  { week:3, dates:["2025-09-15","2025-10-06","2025-11-03","2025-11-24","2025-12-15"] }
];

// Menus
const MENUS = {
  1: {
    Monday: "Oven baked sausages / Vegetarian sausage\nAccompaniments\nFruit / Biscuit",
    Tuesday: "BBQ chicken wrap / Cheese and tomato pizza\nAccompaniments\nFruit yoghurt / Fresh fruit",
    Wednesday: "Cheesy beany jacket / Breaded chicken steak\nAccompaniments\nPancake and fruit",
    Thursday: "Cottage pie / Tomato pasta bake\nAccompaniments\nCookie / Fresh fruit",
    Friday: "Baked fish / Cheese wrap\nAccompaniments\nJam split and fruit wedge"
  },
  2: {
    Monday: "Chicken burger in a bun / Cheese and tomato pizza\nAccompaniments\nFruit or cookie",
    Tuesday: "Pasta bolognese / Vegetarian hotdog\nAccompaniments\nFruit yoghurt / Fresh fruit",
    Wednesday: "Roast chicken / Quorn fillet\nAccompaniments\nFruit crumble",
    Thursday: "Sausage and mash / Vegetable curry\nAccompaniments\nFruit / Jelly",
    Friday: "Fish fingers / Omelette\nAccompaniments\nChocolate sponge"
  },
  3: {
    Monday: "Beef burger / Veggie burger\nAccompaniments\nFruit or muffin",
    Tuesday: "Chicken curry / Macaroni cheese\nAccompaniments\nFruit yoghurt / Fresh fruit",
    Wednesday: "Roast pork / Quorn roast\nAccompaniments\nFruit pie",
    Thursday: "Lasagne / Vegetable chilli\nAccompaniments\nFruit / Ice cream",
    Friday: "Battered fish / Cheese wrap\nAccompaniments\nCupcake"
  }
};

const weekdays = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];

// Helpers
function formatDateRange(startStr) {
  const start = new Date(startStr);
  const end = new Date(start);
  end.setDate(end.getDate() + 4); // Monday–Friday
  const opts = { day:"numeric", month:"short" };
  return `${start.toLocaleDateString("en-GB", opts)} – ${end.toLocaleDateString("en-GB", opts)}`;
}

function getCurrentWeek() {
  const today = new Date();
  const day = today.getDay();
  const adjusted = new Date(today);

  if (day === 6) adjusted.setDate(adjusted.getDate() - 1); // Saturday
  else if (day === 0) adjusted.setDate(adjusted.getDate() + 1); // Sunday

  for (const w of weekMap) {
    for (const d of w.dates) {
      const start = new Date(d);
      const end = new Date(start); end.setDate(end.getDate() + 6);
      if (adjusted >= start && adjusted <= end) return w.week;
    }
  }
  return 1;
}

// State
let currentWeek = getCurrentWeek();
let showingWeek = currentWeek;

// Day logic
let today = new Date();
let todayName = weekdays[today.getDay()];
let tomorrow = new Date();
tomorrow.setDate(today.getDate()+1);
if(tomorrow.getDay()===6){ tomorrow.setDate(tomorrow.getDate()+2); }
if(tomorrow.getDay()===0){ tomorrow.setDate(tomorrow.getDate()+1); }
let tomorrowName = weekdays[tomorrow.getDay()];

// Storage
let packedLunch = JSON.parse(localStorage.getItem('packedLunch') || '{}');

// Render
function renderMenu(week) {
  const container = document.getElementById("menuContainer");
  container.innerHTML = "";
  document.getElementById("weekLabel").textContent = "Week " + week;

  // Show correct date range
  let dateStr = "";
  for (const w of weekMap) {
    if (w.week === week) {
      dateStr = formatDateRange(w.dates[0]); // pick first valid start
      break;
    }
  }
  document.getElementById("weekDates").textContent = dateStr;

  ["Monday","Tuesday","Wednesday","Thursday","Friday"].forEach(day => {
    const card = document.createElement("div");
    card.classList.add("card");
    if (packedLunch[week]?.[day]) card.classList.add("packed");
    if (week === currentWeek && day === todayName) card.classList.add("today-card");

    const dayName = document.createElement("div");
    dayName.classList.add("day-name");
    dayName.textContent = day;

    const meals = document.createElement("div");
    meals.classList.add("meals");
    meals.textContent = MENUS[week][day] || "No data";

    const toggle = document.createElement("label");
    toggle.classList.add("toggle");
    const input = document.createElement("input");
    input.type = "checkbox";
    input.checked = !!(packedLunch[week]?.[day]);
    const slider = document.createElement("span");
    slider.classList.add("slider");
    toggle.appendChild(input);
    toggle.appendChild(slider);

    const labelSpan = document.createElement("span");
    if (week === currentWeek) {
      if (day === todayName) { labelSpan.textContent = "Today"; labelSpan.classList.add("label","today"); }
      else if (day === tomorrowName) { labelSpan.textContent = "Tomorrow"; labelSpan.classList.add("label","tomorrow"); }
    }

    input.addEventListener("change", () => {
      if (input.checked) {
        card.classList.add("packed");
        packedLunch[week] = packedLunch[week] || {};
        packedLunch[week][day] = true;
      } else {
        card.classList.remove("packed");
        if (packedLunch[week]) delete packedLunch[week][day];
      }
      localStorage.setItem('packedLunch', JSON.stringify(packedLunch));
    });

    card.appendChild(dayName);
    card.appendChild(meals);
    card.appendChild(toggle);
    card.appendChild(labelSpan);
    container.appendChild(card);
  });

  // Update toggle button
  const btn = document.getElementById("toggleWeekBtn");
  if (week === currentWeek) {
    const nextWeek = currentWeek % 3 + 1;
    btn.textContent = "View Next Week (Week " + nextWeek + ")";
  } else {
    btn.textContent = "Back to Current Week (Week " + currentWeek + ")";
  }
}

// Toggle button
document.getElementById("toggleWeekBtn").addEventListener("click", () => {
  if (showingWeek === currentWeek) {
    showingWeek = currentWeek % 3 + 1;
  } else {
    showingWeek = currentWeek;
  }
  renderMenu(showingWeek);
});

// First render
renderMenu(currentWeek);
</script>
</body>
</html>
