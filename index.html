<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>School Dinner Menu</title>
<link rel="apple-touch-icon" sizes="180x180" href="https://raw.githubusercontent.com/lambertlambert2004/Dinner/main/icon-180.PNG">
<style>
:root{
  --bg:#f7f7f7;
  --card:#fff;
  --muted:#888;
  --text:#222;
  --accent:#007aff;
  --accent-dark:#0062cc;
  --warm:#ff9500;
  --packed-bg:#fff9d6;
  --other-bg-start:#f0fff6;
  --other-bg-end:#e6fff2;
}
html,body{height:100%;margin:0;padding:0;background:var(--bg);font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Segoe UI",Roboto,Helvetica,Arial,sans-serif;color:var(--text);}
.app{max-width:820px;margin:0 auto;padding:20px;}
h1{text-align:center;font-weight:800;font-size:1.6rem;margin:0 0 8px;}
h1::after{content:"";display:block;margin:8px auto 0;width:60px;height:2px;background:#e3e4e8;border-radius:2px;}
.meta{text-align:center;margin-bottom:14px;}
.week-label{font-weight:700;font-size:1rem;}
.week-dates{font-size:.9rem;color:var(--muted);margin-top:6px;}
#menuContainer{display:flex;flex-direction:column;gap:14px;position:relative;scroll-behavior:smooth;overflow-y:auto;max-height:75vh;padding-bottom:20px;}
.card{background:var(--card);border-radius:14px;padding:14px;position:relative;opacity:0;transform:translateY(12px) scale(0.98);transition:transform .35s ease,opacity .3s ease, box-shadow .3s ease;}
.card.other-day{background:linear-gradient(145deg,var(--other-bg-start),var(--other-bg-end));}
.card.packed{background:linear-gradient(145deg,var(--packed-bg),#fff4b2);}
.card[data-offset]{transform:translateY(calc(var(--offset)*8px)) scale(0.98);}
.day-name{font-weight:700;font-size:1.05rem;margin-bottom:8px;color:var(--text);}
.meals{white-space:pre-line;font-size:.96rem;color:#333;line-height:1.5;margin-bottom:6px;}
.label{position:absolute;top:12px;right:12px;font-weight:700;font-size:.73rem;color:#fff;padding:6px 9px;border-radius:11px;display:flex;align-items:center;}
.label.today{background:#007aff;}
.label.tomorrow{background:#ff9500;}
.label.today::before,
.label.tomorrow::before {
  content: '';
  display: inline-block;
  width:16px;
  height:16px;
  margin-right:6px;
  vertical-align:middle;
  background-size:contain;
  background-repeat:no-repeat;
  animation:floatIcon 2.5s ease-in-out infinite alternate;
}
.label.today::before { background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23fff"><circle cx="12" cy="12" r="10"/></svg>'); }
.label.tomorrow::before { background-image:url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="%23fff"><path d="M12 2 L12 22 M2 12 L22 12"/></svg>'); }
@keyframes floatIcon{0%{transform:translateY(0px);}50%{transform:translateY(-3px);}100%{transform:translateY(0px);}}

.toggle{display:inline-block;width:56px;height:32px;position:relative;margin-top:6px;}
.toggle input{opacity:0;width:0;height:0;}
.slider{position:absolute;inset:0;border-radius:32px;background:#ddd;transition:background .22s,border-color .22s;}
.slider::before{content:"";position:absolute;left:4px;bottom:4px;width:24px;height:24px;background:#fff;border-radius:50%;transition:transform .18s, box-shadow .18s;}
input:checked + .slider{background:#34c759;}
input:checked + .slider::before{transform:translateX(24px);}
.view-banner{position:fixed;top:12px;left:50%;transform:translateX(-50%);display:flex;align-items:center;justify-content:space-between;gap:12px;padding:10px 16px;background:rgba(0,122,255,0.15);backdrop-filter:blur(6px);border-radius:14px;box-shadow:0 8px 20px rgba(0,122,255,0.3);z-index:999;animation:glowBanner 2s ease-in-out infinite alternate;}
.view-banner .text{font-weight:600;color:#007aff;}
.view-banner .sub{color:#fff;font-weight:700;font-size:.95rem;margin-left:6px;}
.banner-actions{display:flex;gap:8px;align-items:center;}
.banner-btn{background:#007aff;color:#fff;border:none;padding:8px 12px;border-radius:10px;font-weight:700;cursor:pointer;box-shadow:0 6px 14px rgba(0,122,255,0.18);}
.banner-btn:active{transform:scale(.98);background:#0062cc;}
.controls{display:flex;justify-content:center;margin-top:12px;}
.week-toggle{background:#007aff;color:#fff;border:none;padding:12px 18px;border-radius:12px;cursor:pointer;font-weight:700;box-shadow:0 8px 22px rgba(0,122,255,0.18);}
.week-toggle:active{transform:scale(.99);background:#0062cc;}
.today-card::after,.tomorrow-card::after{content:"";position:absolute;inset:0;border-radius:14px;z-index:-1;}
.today-card::after{animation:glowPulseBlue 3s ease-in-out infinite;}
.tomorrow-card::after{animation:glowWarm 4s ease-in-out infinite;}
@keyframes glowPulseBlue{0%{box-shadow:0 0 12px 2px rgba(0,122,255,0.12);}50%{box-shadow:0 0 24px 4px rgba(0,122,255,0.18);}100%{box-shadow:0 0 12px 2px rgba(0,122,255,0.12);}}
@keyframes glowWarm{0%{box-shadow:0 0 8px 1px rgba(255,149,0,0.12);}50%{box-shadow:0 0 20px 4px rgba(255,149,0,0.18);}100%{box-shadow:0 0 8px 1px rgba(255,149,0,0.12);}}
@keyframes glowBanner{0%{box-shadow:0 0 16px 4px rgba(0,122,255,0.25);}100%{box-shadow:0 0 24px 8px rgba(0,122,255,0.35);}}
@media(max-width:420px){.app{padding:14px;} h1{font-size:1.35rem;} .banner-btn{padding:8px 10px;}}
</style>
</head>
<body>
<div class="app">
<h1>School Dinner Menu</h1>
<div class="meta">
  <div class="week-label" id="weekLabel">Week</div>
  <div class="week-dates" id="weekDates"></div>
</div>

<div id="viewBanner" class="view-banner" style="display:none;">
  <div class="text">Viewing Week <span id="bannerWeek">1</span><span class="sub"> â€” Not current</span></div>
  <div class="banner-actions"><button id="bannerBackBtn" class="banner-btn">Back to current week</button></div>
</div>

<div id="menuContainer" aria-live="polite"></div>

<div class="controls">
  <button id="toggleWeekBtn" class="week-toggle">View Next Week</button>
</div>

<footer style="margin-top:18px;text-align:center;color:#666;font-size:.88rem;">
Baked salmon available every Friday as an alternative. Data last updated per Swansea Council 2025.
</footer>
</div>

<script>
// WEEK DATA
const weekMap=[
  {week:1,start:"2025-09-01"},
  {week:2,start:"2025-09-08"},
  {week:3,start:"2025-09-15"}
];

const MENUS={
1:{Monday:"Oven baked sausages / Vegetarian sausage\nAccompaniments\nFruit / Biscuit",Tuesday:"BBQ chicken wrap / Cheese and tomato pizza\nAccompaniments\nFruit yoghurt / Fresh fruit",Wednesday:"Cheesy beany jacket / Breaded chicken steak\nAccompaniments\nPancake and fruit",Thursday:"Cottage pie / Tomato pasta bake\nAccompaniments\nCookie / Fresh fruit",Friday:"Baked fish / Cheese wrap\nAccompaniments\nJam split and fruit wedge"},
2:{Monday:"Chicken burger / Cheese and tomato pizza\nAccompaniments\nFruit / Biscuit",Tuesday:"Pasta bolognese / Vegetarian hotdog\nAccompaniments\nFruit / Yoghurt",Wednesday:"Roast chicken / Quorn fillet\nAccompaniments\nPotatoes / Vegetables / Dessert",Thursday:"Fish fingers / Veggie fingers\nAccompaniments\nFruit / Cake",Friday:"Baked fish / Cheese wrap\nAccompaniments\nJam split and fruit wedge"},
3:{Monday:"Mac & cheese / Veggie macaroni\nAccompaniments\nFruit / Biscuit",Tuesday:"Chicken curry / Vegetable curry\nAccompaniments\nRice / Fruit",Wednesday:"Roast pork / Quorn roast\nAccompaniments\nPotatoes / Veggies / Dessert",Thursday:"Tomato pasta bake / Veggie lasagna\nAccompaniments\nCookie / Fresh fruit",Friday:"Baked fish / Cheese wrap\nAccompaniments\nJam split and fruit wedge"}
};

// STATE
let packedLunch=JSON.parse(localStorage.getItem('packedLunch')||"{}");
let currentWeek, showingWeek;

// HELPERS
function parseDate(str){return new Date(str+"T00:00:00");}
function getWeekRange(startDate){let start=parseDate(startDate); let end=new Date(start); end.setDate(start.getDate()+4); return {start,end};}
function getCurrentWeek(){
  const today=new Date();
  const isSunday = today.getDay() === 0;
  for(let i=0;i<weekMap.length;i++){
    let range=getWeekRange(weekMap[i].start);
    if(today >= range.start && today <= range.end) 
        return isSunday ? ((i+1)<weekMap.length ? weekMap[i+1].week : weekMap[0].week) : weekMap[i].week;
  }
  return weekMap[0].week; // Cycle to first week if outside all ranges
}
function formatWeekStart(weekNum){return weekMap.find(w=>w.week===weekNum).start;}

// RENDER
const menuContainer=document.getElementById('menuContainer');
const weekLabel=document.getElementById('weekLabel');
const weekDates=document.getElementById('weekDates');
const viewBanner=document.getElementById('viewBanner');
const bannerWeek=document.getElementById('bannerWeek');
const bannerBackBtn=document.getElementById('bannerBackBtn');
const toggleWeekBtn=document.getElementById('toggleWeekBtn');

function renderMenu(week){
  menuContainer.innerHTML="";
  weekLabel.textContent="Week "+week;
  weekDates.textContent="Week commencing: "+formatWeekStart(week);

  const weekdays=["Monday","Tuesday","Wednesday","Thursday","Friday"];
  const startDate=parseDate(formatWeekStart(week));
  const todayObj=new Date();
  const tomorrowObj=new Date(); tomorrowObj.setDate(todayObj.getDate()+1);

  weekdays.forEach((day,idx)=>{
    const card=document.createElement('div'); card.classList.add('card');
    const dayName=document.createElement('div'); dayName.textContent=day; dayName.classList.add('day-name');
    const meals=document.createElement('div'); meals.classList.add('meals'); meals.textContent=MENUS[week][day]||"No data";

    const dayDate=new Date(startDate); dayDate.setDate(startDate.getDate()+idx);

    const label=document.createElement('span'); label.classList.add('label');

    if(todayObj.toDateString()===dayDate.toDateString()){label.textContent="Today"; label.classList.add('today-card');}
    else if(tomorrowObj.toDateString()===dayDate.toDateString()){label.textContent="Tomorrow"; label.classList.add('tomorrow-card');}

    meals.appendChild(label);

    const toggleDiv=document.createElement('div'); const toggleLabel=document.createElement('label'); toggleLabel.classList.add('toggle');
    const input=document.createElement('input'); input.type="checkbox"; input.checked=!!(packedLunch[week]&&packedLunch[week][day]);
    const slider=document.createElement('span'); slider.classList.add('slider');
    toggleLabel.appendChild(input); toggleLabel.appendChild(slider); toggleDiv.appendChild(toggleLabel);

    input.addEventListener('change',()=>{
      if(!packedLunch[week]) packedLunch[week]={};
      if(input.checked){packedLunch[week][day]=true; card.classList.add('packed'); card.classList.remove('other-day');}
      else{delete packedLunch[week][day]; card.classList.remove('packed'); card.classList.add('other-day');}
      localStorage.setItem('packedLunch',JSON.stringify(packedLunch));
      if(navigator.vibrate){navigator.vibrate(20);}
    });

    card.appendChild(dayName); card.appendChild(meals); card.appendChild(toggleDiv);
    if(input.checked){card.classList.add('packed');} else {card.classList.add('other-day');}
    menuContainer.appendChild(card);
    setTimeout(()=>{card.style.opacity=1; card.style.transform="translateY(0) scale(1)";},50);
  });

  applyParallax();
  viewBanner.style.display=(showingWeek!==currentWeek)?"flex":"none"; bannerWeek.textContent=showingWeek;
}

// CONTROLS
toggleWeekBtn.addEventListener('click',()=>{showingWeek=(showingWeek%3)+1; renderMenu(showingWeek);});
bannerBackBtn.addEventListener('click',()=>{showingWeek=currentWeek; renderMenu(showingWeek);});

// SWIPE NAVIGATION
let touchStartX=0; let touchEndX=0;
menuContainer.addEventListener('touchstart',(e)=>{touchStartX=e.changedTouches[0].screenX;},{passive:true});
menuContainer.addEventListener('touchend',(e)=>{touchEndX=e.changedTouches[0].screenX; handleSwipeGesture();},{passive:true});
function handleSwipeGesture(){
  const threshold=50;
  if(touchEndX<touchStartX-threshold){showingWeek=(showingWeek%3)+1; renderMenu(showingWeek);}
  if(touchEndX>touchStartX+threshold){showingWeek=(showingWeek-2+3)%3+1; renderMenu(showingWeek);}
}

// PARALLAX EFFECT
function applyParallax(){
  const cards=document.querySelectorAll('#menuContainer .card');
  cards.forEach((card,i)=>{card.style.setProperty('--offset',i);});
}

// INIT
currentWeek=getCurrentWeek();
showingWeek=currentWeek;
renderMenu(showingWeek);
</script>
</body>
</html>
